# Global prefix that prefixes all metrics generated by this deployment.  A _ separator is added automatically.
metricPrefix: awssdk

# Uncomment and edit the section below if you wish to deploy to an EKS Cluster.
#deploymentConfig:
#  # Create / Determine your OIDC provider.  See: https://docs.aws.amazon.com/eks/latest/userguide/enable-iam-roles-for-service-accounts.html
#  oidcProvider: oidc.eks.[region].amazonaws.com/id/[identifier]
#  # The namespace that will be used for our metric gathering container.  It will be created if it doesn't exist.
#  namespace: aws-sdk-prom-metrics
#  # Your AWS Account ID.  Used while constructing the roles trust information.
#  awsAccountId: "012345678910"
#  # The URI to retrieve the container image you built with 'make docker' and pushed to.
#  imageUri: 012345678910.dkr.ecr.[region].amazonaws.com/aws-sdk-prom-metrics:label
#  # The Service Account Name that will be created in the EKS cluster.
#  serviceAccountName: aws-sdk-prom-metrics

# The metric example below can be used to extract the current state of an Amazon FSx for Lustre (FSxL) Filesystem.
# This can be helpful for FSxL SCRATCH type filesystems which don't recover from failure automatically.
# Additionally, helpful to understand total filesystem storage if you wish to calculate percentage space remaining in a Grafana dashboard.
metrics:
  # How often (in minutes) to run our SDK command
  - frequency: 1
    # The name of the metric in Prometheus.  This will be prefixed by the 'metricPrefix' listed above.
    metricName: "fsxl_filesystem_information"
    # The help message that accompanies the metric in Prometheus
    metricHelp: FSxL Filesystem Information
    # The name of the SDK Library to use.  For available libraries see: https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/index.html
    sdkLibrary: "@aws-sdk/client-fsx"
    # The name of the client within the library above.  ie: https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-fsx/index.html
    sdkClientName: "FSxClient"
    # The command we want our sdk to run.  ie: https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-fsx/classes/describefilesystemscommand.html
    sdkCommand: "DescribeFileSystemsCommand"
    # The Action, and Resources section for permissions required for this command to work.  These are optional and only used if 'deploymentConfig' is setup.
    iamPermissions:
      actions:
        - fsx:DescribeFileSystems
      resources:
        # You can limit this scope to specific FSxL Filesystem resource ARNs if they are known up-front
        - '*'
    labels:
      # Knowing our commands output shape
      #     (ie: https://docs.aws.amazon.com/AWSJavaScriptSDK/v3/latest/clients/client-fsx/interfaces/describefilesystemscommandoutput.html)
      # We can use a JSON Pointer (https://datatracker.ietf.org/doc/html/rfc6901) to set and get values.
      # We will focus on labels (creating a Summary instead of a Gauge) in this example
      filesystem_id: '$.FileSystems[*].FileSystemId'
      lifecycle: '$.FileSystems[*].Lifecycle'
      storage_capacity: '$.FileSystems[*].StorageCapacity'
    # By default, we will gather metrics for all filesystems.  We can fine-tune this knowing our command input shape if desired.
    # Uncomment the line below if the specific list of filesystems you wish to describe is known up-front.
#    sdkCommandInput:
#      FileSystemIds:
#        # Add more filesystem identifiers to this array if they are known up-front.
#        - [identifier]